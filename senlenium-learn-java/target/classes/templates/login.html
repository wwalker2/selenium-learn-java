<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Login - Selenium Learning App</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 2rem; }
      label, input, button { display: block; margin: 0.5rem 0; }
      #login-message { margin-top: 1rem; font-weight: bold; }
      .success { color: #2a7; }
      .error { color: #d22; }
    </style>
  </head>
  <body>
    <h1>Login</h1>

    <form id="login-form">
      <label for="username">Username</label>
      <input id="username" name="username" type="text" placeholder="Username" />

      <label for="password">Password</label>
      <input id="password" name="password" type="password" placeholder="Password" />

      <button id="login" type="submit">Log in</button>
    </form>

    <p id="login-message" aria-live="polite" style="display: none;"></p>

    <script>
      // Client-side code now defers to the server for authentication.
      document.getElementById('login-form').addEventListener('submit', function (e) {
        e.preventDefault();
        var username = document.getElementById('username').value.trim();
        var password = document.getElementById('password').value.trim();
        var msg = document.getElementById('login-message');

        msg.style.display = 'none';
        msg.textContent = '';

        // Call server POST /login with JSON payload. Server will validate credentials.
        fetch('/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username: username, password: password })
        })
        .then(function (res) {
          if (!res.ok) throw new Error('Network response was not ok');
          return res.json();
        })
        .then(function (data) {
          msg.textContent = data.message || '';
          msg.className = data.success ? 'success' : 'error';
          msg.style.display = 'block';
        })
        .catch(function (err) {
          msg.textContent = 'Error communicating with server';
          msg.className = 'error';
          msg.style.display = 'block';
        });
      });
    </script>
  </body>
</html>
